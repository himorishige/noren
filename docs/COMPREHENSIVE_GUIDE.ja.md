# Noren: åŒ…æ‹¬çš„ã‚¬ã‚¤ãƒ‰ - ç¾ä»£ã®é­”æ³•ä½¿ã„ã®ãŸã‚ã®PIIä¿è­·å…¥é–€

## 1. ã“ã®é­”æ³•ï¼ˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ãŒç”Ÿã¾ã‚ŒãŸèƒŒæ™¯

â€¦â€¦ãµãƒ¼ã‚“ã€æœ€è¿‘ã®é­”æ³•ä½¿ã„ã¯ã€Model Context Protocol (MCP)ã¨ã‹ã€ãã†ã„ã†æ–°ã—ã„AIã®é­”æ³•ã®ä½œæ³•ã‚’ä½¿ã†ã“ã¨ãŒå¢—ãˆã¦ã„ã‚‹ã‚“ã ã­ã€‚ä¾¿åˆ©ã ã‘ã©ã€è‡ªåˆ†ã®å¤§äº‹ãªè¨˜æ†¶ã‚„åå‰ï¼ˆå€‹äººæƒ…å ±ï¼‰ã‚’ã€æ„å›³ã›ãšå¤–ã®ä¸–ç•Œã«é€ã£ã¦ã—ã¾ã†ã®ã¯ã€ã¡ã‚‡ã£ã¨æ€–ã„ã€‚

ã“ã®ã€ŒNorenã€ã¨ã„ã†é­”æ³•ã¯ã€ãã‚“ãªç¾ä»£ã®é­”æ³•ä½¿ã„ãŸã¡ã®ãŸã‚ã«ä½œã‚‰ã‚ŒãŸã€‚åº—ã®å…¥ã‚Šå£ã«ã‹ã‘ã‚‹ã€Œæš–ç°¾ï¼ˆã®ã‚Œã‚“ï¼‰ã€ãŒã€ä¸­ã®æ§˜å­ã‚’ãã£ã¨éš ã—ã¦ãã‚Œã‚‹ã‚ˆã†ã«ã€ã“ã®é­”æ³•ã¯å›ã®è¨€è‘‰ï¼ˆãƒ‡ãƒ¼ã‚¿ï¼‰ãŒå¤–ã«å‡ºã‚‹å‰ã«ã€ãã®ä¸­ã«ã‚ã‚‹å¤§äº‹ãªæƒ…å ±ï¼ˆPIIï¼‰ã‚’è¦‹ã¤ã‘ã¦ã€éš ã—ãŸã‚Šã€åˆ¥ã®ã‚‚ã®ã«ç½®ãæ›ãˆãŸã‚Šã—ã¦ãã‚Œã‚‹ã€‚

ã„ã‚ã°ã€ç°¡æ˜“çš„ãªé˜²å¾¡çµç•Œã®ã‚ˆã†ãªã‚‚ã®ã ã€‚èª°ã§ã‚‚æ‰‹è»½ã«ä½¿ãˆã‚‹ã‚ˆã†ã«ã€å‘ªæ–‡ã®è© å”±ï¼ˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼‰ã¯ã¨ã¦ã‚‚ç°¡å˜ã«ãªã£ã¦ã„ã‚‹ã€‚

## 2. Norenã®ä¸»ãªç‰¹å¾´

ã“ã®é­”æ³•ã«ã¯ã€ã„ãã¤ã‹ã®é¢ç™½ã„ç‰¹å¾´ãŒã‚ã‚‹ã€‚

*   **ğŸŒ Webæ¨™æº–ã¨ã„ã†å¤ã„é­”æ³•ãŒãƒ™ãƒ¼ã‚¹**
    *   ç‰¹å®šã®å¼·åŠ›ãªåŠ›ï¼ˆNode.jsã®ã‚ˆã†ãªãƒ©ãƒ³ã‚¿ã‚¤ãƒ ï¼‰ã«é ¼ã‚‰ãšã€æ˜”ã‹ã‚‰ã‚ã‚‹Webæ¨™æº–ã¨ã„ã†é­”æ³•ï¼ˆWHATWG Streams, Web Crypto APIï¼‰ã ã‘ã§å‹•ãã€‚ã ã‹ã‚‰ã€è‰²ã€…ãªå ´æ‰€ï¼ˆç’°å¢ƒï¼‰ã§ä½¿ãˆã‚‹ã€‚
*   **ğŸ§© é­”æ³•ã®çµ„ã¿åˆã‚ã›ï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼‰**
    *   æ ¸ã¨ãªã‚‹é­”æ³•ï¼ˆ`noren-core`ï¼‰ã«ã€ä¸–ç•Œä¸­ã®æ§˜ã€…ãªåœ°åŸŸã®é­”æ³•ï¼ˆæ—¥æœ¬å‘ã‘ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€ç±³å›½å‘ã‘ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãªã©ï¼‰ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€è‰²ã€…ãªç¨®é¡ã®å€‹äººæƒ…å ±ã«å¯¾å¿œã§ãã‚‹ã€‚
*   **ğŸ’§ æµã‚Œã‚‹æ°´ã‚’å °ãæ­¢ã‚ã‚‹ã‚ˆã†ãªå‡¦ç†ï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒ å¯¾å¿œï¼‰**
    *   å¤§é‡ã®è¨€è‘‰ï¼ˆãƒ‡ãƒ¼ã‚¿ï¼‰ãŒæµã‚Œã¦ãã¦ã‚‚ã€ãã‚Œã‚’ä¸€åº¦ã«æºœã‚è¾¼ã‚€ã‚“ã˜ã‚ƒãªãã¦ã€æµã‚ŒãªãŒã‚‰å‡¦ç†ã™ã‚‹ã€‚ã ã‹ã‚‰ã€å¤§ããªé­”åŠ›ï¼ˆãƒ¡ãƒ¢ãƒªï¼‰ã‚’æ¶ˆè²»ã—ãªã„ã€‚
*   **âš¡ï¸ ç´ æ—©ã„è© å”±ï¼ˆãƒã‚¤ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼‰**
    *   é­”æ³•é™£ï¼ˆæ­£è¦è¡¨ç¾ï¼‰ã‚’ã‚ã‚‰ã‹ã˜ã‚ç”¨æ„ã—ã¦ãŠãã“ã¨ã§ã€è© å”±ï¼ˆå‡¦ç†ï¼‰ãŒã¨ã¦ã‚‚é€Ÿã„ã€‚

## 3. ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼šæœ€åˆã®é­”æ³•ã‚’è©¦ã™

â€¦â€¦ã¾ã‚ã€ç¿’ã†ã‚ˆã‚Šæ…£ã‚Œã‚ã€ã ã€‚ã¾ãšã¯ç°¡å˜ãªä½¿ã„æ–¹ã‚’èª¬æ˜ã™ã‚‹ã€‚

### æº–å‚™ï¼ˆã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼‰

ã¾ãšã€é­”æ³•ã®é“å…·ï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰ã‚’æ‰‹ã«å…¥ã‚Œã‚‹ã€‚

```sh
pnpm install
```

### åŸºæœ¬çš„ãªçµç•Œè¡“ï¼ˆãƒã‚¹ã‚­ãƒ³ã‚°ï¼‰

ã“ã‚ŒãŒä¸€ç•ªåŸºæœ¬çš„ãªä½¿ã„æ–¹ã€‚åå‰ã‚„é›»è©±ç•ªå·ã®ã‚ˆã†ãªæƒ…å ±ã‚’ã€Œâ—â—â—ã€ã¿ãŸã„ã«éš ã™é­”æ³•ã ã€‚

```javascript
import { Registry, redactText } from '@himorishige/noren-core';
import * as jp from '@himorishige/noren-plugin-jp';
import * as us from '@himorishige/noren-plugin-us';

// ã©ã‚“ãªé­”æ³•ã‚’ä½¿ã†ã‹ç™»éŒ²ã™ã‚‹å ´æ‰€ï¼ˆRegistryï¼‰ã‚’ä½œã‚‹
const reg = new Registry({
  defaultAction: 'mask', // åŸºæœ¬ã¯ã€Œéš ã™ã€
  rules: {
    credit_card: { action: 'mask', preserveLast4: true }, // ã‚«ãƒ¼ãƒ‰ç•ªå·ã¯æœ€å¾Œã®4æ¡ã ã‘è¦‹ã›ã‚‹
    jp_my_number: { action: 'remove' }, // ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã¯å®Œå…¨ã«æ¶ˆã™
  },
  // æ¤œå‡ºã®ãƒ’ãƒ³ãƒˆã«ãªã‚‹è¨€è‘‰ã‚’æ•™ãˆã¦ãŠã
  contextHints: ['TEL', 'é›»è©±', 'ã€’', 'ä½æ‰€', 'Zip', 'Address', 'SSN'],
});

// æ—¥æœ¬ã¨ç±³å›½ã®é­”æ³•ã‚’è¿½åŠ ã§ç™»éŒ²ã™ã‚‹
reg.use(jp.detectors, jp.maskers);
reg.use(us.detectors, us.maskers);

// çµç•Œã‚’å¼µã‚ŠãŸã„æ–‡ç« 
const input = 'ã€’150-0001 TEL 090-1234-5678 / SSN 123-45-6789 / Card: 4242 4242 4242 4242';

// é­”æ³•ã‚’ç™ºå‹•
const output = await redactText(reg, input, { hmacKey: 'a-very-long-and-secure-secret-key-for-testing' });

console.log(output);
// å‡ºåŠ›: ã€’â€¢â€¢â€¢-â€¢â€¢â€¢â€¢ TEL â€¢â€¢â€¢-â€¢â€¢â€¢â€¢-â€¢â€¢â€¢â€¢ / SSN â€¢â€¢â€¢-â€¢â€¢-â€¢â€¢â€¢â€¢ / Card: **** **** **** 4242
```

## 4. é­”æ³•ä½“ç³»ã®è§£èª¬ï¼ˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼‰

Norenã¯ã€ã„ãã¤ã‹ã®é­”æ³•ã®æ›¸ï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰ãŒé›†ã¾ã£ã¦ã§ãã¦ã„ã‚‹ã€‚

| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å | å½¹å‰² |
| :--- | :--- |
| `@himorishige/noren-core` | å…¨ã¦ã®åŸºæœ¬ã¨ãªã‚‹ä¸­æ ¸é­”æ³•ã€‚ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚„IPã‚¢ãƒ‰ãƒ¬ã‚¹ãªã©ã€ä¸–ç•Œå…±é€šã®æƒ…å ±ã‚’æ‰±ã†ã€‚ |
| `@himorishige/noren-plugin-jp` | æ—¥æœ¬å›ºæœ‰ã®é­”æ³•ã€‚é›»è©±ç•ªå·ã€éƒµä¾¿ç•ªå·ã€ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã«å¯¾å¿œã™ã‚‹ã€‚ |
| `@himorishige/noren-plugin-us` | ç±³å›½å›ºæœ‰ã®é­”æ³•ã€‚SSNã‚„ZIPã‚³ãƒ¼ãƒ‰ã«å¯¾å¿œã™ã‚‹ã€‚ |
| `@himorishige/noren-plugin-security` | APIã‚­ãƒ¼ã‚„èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ãªã©ã€æŠ€è¡“çš„ã«å¤§äº‹ãªæƒ…å ±ã‚’å®ˆã‚‹ãŸã‚ã®é­”æ³•ã€‚ |
| `@himorishige/noren-dict-reloader` | é­”æ³•ã®ãƒ«ãƒ¼ãƒ«ï¼ˆè¾æ›¸ï¼‰ã‚’ã€çµç•Œã‚’è§£ã‹ãšã«æ›´æ–°ã™ã‚‹ãŸã‚ã®é«˜åº¦ãªé­”æ³•ã€‚ |

## 5. ä¸»è¦ãªå‘ªæ–‡ï¼ˆAPIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ï¼‰

### `Registry`
å…¨ã¦ã®é­”æ³•ã®ãƒ«ãƒ¼ãƒ«ã‚’ç®¡ç†ã™ã‚‹å ´æ‰€ã€‚ã©ã‚“ãªæƒ…å ±ã‚’ã€ã©ã†ã‚„ã£ã¦éš ã™ã‹ã‚’ã“ã“ã§æ±ºã‚ã‚‹ã€‚

### `redactText(registry, text, options)`
å®Ÿéš›ã«çµç•Œã‚’å¼µã‚‹ï¼ˆãƒã‚¹ã‚­ãƒ³ã‚°ã‚„ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã‚’è¡Œã†ï¼‰ãŸã‚ã®å‘ªæ–‡ã€‚

### `createRedactionTransform()`
æµã‚Œã‚‹è¨€è‘‰ï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼‰ã«å¯¾ã—ã¦çµç•Œã‚’å¼µã‚Šç¶šã‘ã‚‹ãŸã‚ã®é­”æ³•é™£ã€‚

## 6. æ´»ç”¨äº‹ä¾‹ï¼šã“ã‚“ãªæ™‚ã«ä½¿ãˆã‚‹

### ä¾‹1ï¼šå¤§äº‹ãªä¼šè©±ã®è¨˜éŒ²ï¼ˆãƒ­ã‚°ï¼‰ã‹ã‚‰å€‹äººåã‚’éš ã™

```javascript
const supportTicket = `
Customer: John Doe (john.doe@example.com)
Phone: +1-555-123-4567
Issue: Payment failed for card 4242 4242 4242 4242.
`;
const masked = await redactText(registry, supportTicket);
console.log(masked);
/*
Customer: John Doe ([REDACTED:email])
Phone: [REDACTED:us_phone]
Issue: Payment failed for card **** **** **** 4242.
*/
```

### ä¾‹2ï¼šæƒ…å ±ã‚’åˆ¥ã®å°ã«ç½®ãæ›ãˆã‚‹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³åŒ–ï¼‰

æƒ…å ±ã‚’å®Œå…¨ã«éš ã™ä»£ã‚ã‚Šã«ã€ç„¡æ„å‘³ã ã‘ã©ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå°ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ã«ç½®ãæ›ãˆã‚‹é­”æ³•ã€‚å¾Œã‹ã‚‰åŒã˜æƒ…å ±ã‹ã©ã†ã‹ã‚’ç…§åˆã—ãŸã„æ™‚ã«ä¾¿åˆ©ã ã€‚

```javascript
const customerRecord = {
  email: "jane.smith@example.com",
  phone: "555-987-6543",
};
const tokenized = await redactText(registry, JSON.stringify(customerRecord), {
  rules: { email: { action: 'tokenize' }, us_phone: { action: 'tokenize' } },
  hmacKey: 'a-very-long-and-secure-secret-key-for-tokenization'
});
console.log(JSON.parse(tokenized));
/*
{
  "email": "TKN_EMAIL_a1b2c3d4e5f67890",
  "phone": "TKN_US_PHONE_9f8e7d6c5b4a3210"
}
*/
```

### ä¾‹3ï¼šWebã‚µãƒ¼ãƒãƒ¼ã§ä½¿ã†

Webã‚µãƒ¼ãƒãƒ¼ã«å±Šã„ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ç›´æ¥çµç•Œã‚’å¼µã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚

```javascript
// examples/hono-server.mjs ã‚’è¦‹ã¦ã¿ã¦
import { Hono } from 'hono';
const app = new Hono();

app.post('/redact', async (c) => {
  const body = c.req.raw.body; // ReadableStream
  if (!body) return c.text('no body', 400);
  const redacted = body.pipeThrough(createRedactionTransform(registry));
  return new Response(redacted);
});
```

## 7. é‡è¦ãªæ³¨æ„äº‹é …ï¼šã“ã®é­”æ³•ã®é™ç•Œ

â€¦â€¦ã•ã¦ã€å¤§äº‹ãªè©±ã ã€‚
ã“ã®é­”æ³•ã¯ã€ã‚ãã¾ã§æ‰‹è»½ã«ä½¿ãˆã‚‹ç°¡æ˜“çš„ãªçµç•Œã ã€‚æ—¥å¸¸çš„ãªã†ã£ã‹ã‚ŠãƒŸã‚¹ã‚’é˜²ãã®ã«ã¯å½¹ç«‹ã¤ã‘ã©ã€**å®Œç’§ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ãªã„**ã€‚

é‡‘èæƒ…å ±ã‚„ã€å³æ ¼ãªæ³•å¾‹ï¼ˆGDPRã‚„CCPAãªã©ï¼‰ãŒé–¢ã‚ã‚‹ã‚ˆã†ãªã€æœ¬å½“ã«å¤§äº‹ãªæƒ…å ±ã‚’æ‰±ã†å ´åˆã¯ã€ã“ã®é­”æ³•ã ã‘ã«é ¼ã‚‹ã®ã¯å±é™ºã ã€‚

ãã†ã„ã†æ™‚ã¯ã€ã‚‚ã£ã¨å¼·åŠ›ãªé˜²è¡›é­”æ³•ã‚’æä¾›ã—ã¦ã„ã‚‹å°‚é–€å®¶ãŸã¡ï¼ˆAWS, Google Cloud, Azureãªã©ï¼‰ã‚’é ¼ã‚‹ã“ã¨ã€‚å½¼ã‚‰ã¯ã€å·¨å¤§ãªåŸå£ã‚„è¦‹å¼µã‚Šç•ªï¼ˆãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ï¼‰ã‚’ç”¨æ„ã—ã¦ãã‚Œã¦ã„ã‚‹ã€‚

*   **AWS**: [Amazon Comprehend](https://docs.aws.amazon.com/comprehend/latest/dg/how-pii.html), [Amazon Macie](https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html)
*   **Google Cloud**: [Sensitive Data Protection (Cloud DLP)](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
*   **Azure**: [Azure AI Language (PII Detection)](https://learn.microsoft.com/azure/ai-services/language-service/personally-identifiable-information/how-to/redact-text-pii)

ã“ã®Norenã¯ã€ã‚ãã¾ã§è£œåŠ©çš„ãªé­”æ³•ã¨ã—ã¦ã€è³¢ãä½¿ã†ã“ã¨ã€‚ã„ã„ã­ï¼Ÿ

## 8. è²¢çŒ®

â€¦â€¦ã‚‚ã—ã€ã“ã®é­”æ³•ä½“ç³»ã«èˆˆå‘³ãŒå‡ºãŸã‚‰ã€å›ã‚‚å”åŠ›ã—ã¦ãã‚Œã‚‹ã¨å¬‰ã—ã„ã€‚è©³ã—ãã¯ `CONTRIBUTING.md` ã‚’èª­ã‚“ã§ã¿ã¦ã€‚
